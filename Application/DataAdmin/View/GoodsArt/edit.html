<include file="Public/header"/>
<js file='__PUBLIC__/Common/Ueditor/ueditor.config.js' />
<js file='__PUBLIC__/Common/Ueditor/ueditor.all.min.js' />
<body>
<style>
    .imgs{
	    position:relative;
    }
	.imgDiv{
		position:absolute;
		padding:10px;
		font-size:20px;
		right:350px;
		top:-10px;
	}
</style>
<include file="Public/nav"/>
<div class="down-main">
  <include file="Public/left"/>
  <div class="right-product right-full">
          <!---rightcontent-->
            <div class="container-fluid">
              <div class="info-center">
                <!-- header -->
                <div class="page-header">
	              	<div class="pull-left">
	                	<h4>发现管理</h4>
	            	</div>
	            </div>
                <div class="clearfix"></div>
                <div class="content-list">
					<!--内容开始-->
					<form class="form-horizontal" method="post" action="{:U('edit_to')}" name="basic_validate" id="signupForm">
					        <input type="hidden" name="id" value="{$list.id}">
							<div class="form-group">
								<label class="col-sm-1 control-label">类型<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<select name="type" class="form-control type">
										<option value="" <if condition="$list.type heq ''"> selected="selected"</if>>请选择类型</option>
										<option value="1" <if condition="$list.type heq '1'"> selected="selected"</if>>商学院</option>
										<option value="2" <if condition="$list.type heq '2'"> selected="selected"</if>>好文</option>
										<option value="3" <if condition="$list.type heq '3'"> selected="selected"</if>>精选</option>
									</select>
								</div>
							</div>
							<div class=""></div>
							<div class="form-group title">
								<label class="col-sm-1 control-label">标题<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<input type="text" id="title" name="title" value="{$list.title}" dataType="*" placeholder="标题" class="form-control" >
								</div>
							</div>
							<div class=""></div>
							<div class="form-group tag">
								<label class="col-sm-1 control-label">标签<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<select name="tag" class="form-control">
									    <option value=""  <if condition="$list.tag eq ''"> selected="selected"</if>>请选择类型</option>
										<option value="时尚" <if condition="$list.tag eq '时尚'"> selected="selected"</if>>时尚</option>
										<option value="科技" <if condition="$list.tag eq '科技'"> selected="selected"</if>>科技</option>
										<option value="文学" <if condition="$list.tag eq '文学'"> selected="selected"</if>>文学</option>
										<option value="美食" <if condition="$list.tag eq '美食'"> selected="selected"</if>>美食</option>
										<option value="教材" <if condition="$list.tag eq '教材'"> selected="selected"</if>>教材</option>
								     </select>
								</div>
							</div>
							<div class=""></div>
							<div class="form-group author">
								<label class="col-sm-1 control-label">作者<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<input type="text" id="author" name="author" value="{$list.author}" dataType="*" placeholder="作者" class="form-control" >
								</div>
							</div>
							<div class=""></div>
							<!-- <div class="form-group link">
								<label class="col-sm-1 control-label">链接<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<input type="text" id="video" name="video" value="{$list.video}" dataType="*" placeholder="视频链接" class="form-control" >
								</div>
							</div>
							<div class=""></div> -->
							<div class="form-group">
								<label class="col-sm-1 control-label">排序<i style="color:red;"></i></label>
								<div class="col-sm-6">
									<input type="text" id="sort" name="sort" value="{$list.sort}" dataType="*" placeholder="填写数字" class="form-control" >
								</div>
							</div>
							<div class=""></div>
							<div class="form-group recommend" style="display:none;">
								<label class="col-sm-1 control-label">主编推荐<i style="color:red;"></i></label>
								<div class="col-sm-6">
									<input type="radio" id="recommend" name="recommend" value="1" <if condition="$list.recommend eq 1">checked</if>>是&nbsp;&nbsp;&nbsp;&nbsp;
									<input type="radio" id="recommend" name="recommend" value="0" <if condition="$list.recommend eq 0">checked</if>>否&nbsp;&nbsp;&nbsp;&nbsp;
								</div>
							</div>
							<div class=""></div>
							<div class="form-group goodsid" style="display:none;">
								<label class="col-sm-1 control-label">推荐商品id<i style="color:red;">*</i></label>
								<div class="col-sm-6">
									<input type="text" id="goodsid" name="goodsid" value="{$list.goodsid}" dataType="*" placeholder="填写数字" class="form-control" >									
								</div><font color='red' class="more"></font>
							</div>
							<div class=""></div>
							<div class="form-group">
								<label class="col-sm-1 control-label">缩略图<i style="color:red;">*</i> </label>
								<div class="col-sm-6 imgs">
										<img id="upload_img" class="img-circle" src="__ROOT__/Public/DataAdmin/images/upload_img.png" style="width: 80px;height: 80px" />
										<if condition="empty($list)">
										    <div class="imgDiv"></div>
										    <input type="hidden" name="img" id="img"/>
										    <else/>
										    <div class="imgDiv">
										      <img src="{$list.img}" width="80" height="80" />
										    </div>
										    <input type="hidden" name="img" id="img" value="{$list.img}"/>
										</if>
										
								</div>
							</div>
							<div class=""></div>
							<div class="form-group fabuleixing" style="display:none">
								<label class="col-sm-1 control-label">发布类型<i style="color:red;"></i></label>
								<div class="col-sm-6">
									<input type="radio" name="leixing" class="leixing" value="1" class="leixing" <if condition="$list['leixing'] eq 1">checked</if>>视频
									&nbsp;&nbsp;&nbsp;&nbsp;
									<input type="radio" name="leixing" class="leixing" value="2" class="leixing" <if condition="$list['leixing'] eq 2">checked</if>>其他
								</div>
							</div>
							<div class=""></div>
							<div class="form-group vedio" style="display:none;">
								<label class="col-sm-1 control-label">视频链接<i style="color:red;"></i></label>
								<div class="col-sm-6">
									<input type="text" id="video" name="video" value="{$list.video}" dataType="*" placeholder="视频链接" class="form-control" >
								</div>
							</div>
							<!-- <div class="form-group vedio" style="display:none;">
								<label class="col-sm-1 control-label">视频<i style="color:red;">*</i> </label>
								<div class="col-sm-6 imgs">
										<img id="upload_vedio" class="img-circle" src="__ROOT__/Public/DataAdmin/images/upload_img.png" style="width: 80px;height: 80px" />
										<if condition="empty($list)">
										    <div class="imgDiv2"></div>
										    <input type="hidden" name="video" id="video"/>
										    <else/>
										    <div class="imgDiv2">
										    <p>{$list.video}</p>
										    </div>
										    <input type="hidden" name="video" id="video" value="{$list.video}"/>
										</if>
										
								</div>
							</div> -->
							<div class=""></div>							
							<div class="form-group content" style="display:none;">
								<label class="col-sm-1 control-label">详情内容</label>
								<div class="col-sm-6">
									 <script type="text/plain"   name="content"  id="editor" style="width:100%;height:300px;overflow-y:hidden;"></script>
								</div>
							</div>
							<div class=""></div>
							<div class="form-group">
								<div class="col-sm-4 col-sm-offset-2">
									<button class="btn btn-success" id="btn" style="background:#5a98de;">保存内容</button>
									<a class="btn btn-white" href="{:U('index')}">取消</a>
								</div>
							</div>
					</form>
					<!--内容结束-->
                </div>

              </div>
            </div>
  </div>
</div>
</body>
<script type="text/javascript" src="__PUBLIC__/DataAdmin/js/jquery-1.11.1.min.js"></script>
<script src="__PUBLIC__/newMerchant/js/layer/layer.js"></script>
<script type="text/javascript">
	$(function(){
		$(".leixing").change(function(){
			var lx = $(this).val();
			if(lx==1){
				$(".vedio").show();
			}else if(lx==2){
				$(".vedio").hide();
			}
		})
		
		
		$(".type").change(function(){
			var value = $(this).val();
		    if(value==2 || value==1){
		    	$(".content").show();
		    	$(".more").text("(多个商品请用','号隔开)");
		    }else{
		    	$(".content").hide();
		    	$(".more").text("填写1个就可以");
		    }
		    
		    if(value==2 || value==3){
		    	$(".goodsid").show();
		    	$(".recommend").show();
		    }else{
		    	$(".goodsid").hide();
		    	$(".recommend").hide();
		    }
		    
		    if(value==1){
		    	$(".link").show();
		    	$(".vedio").show();
		    	$(".fabuleixing").show();
		    }else{
		    	$(".link").hide();
		    	$(".vedio").hide();
		    	$(".fabuleixing").hide();
		    }
		    
		    if(value==3){
		    	$(".title").hide();
		    	$(".tag").hide();
		    	$(".author").hide();
		    	$(".click").hide();
		    	$(".num").hide();
		    }else{
		    	$(".title").show();
		    	$(".tag").show();
		    	$(".author").show();
		    	$(".click").show();
		    	$(".num").show();
		    }
		    
		})
		var types = $(".type").val();
		
		if(types==2 || types==1){
	    	$(".content").show();
	    	$(".more").text("(多个商品请用','号隔开)");
	    }else{
	    	$(".content").hide();
	    	$(".more").text("填写1个就可以");
	    }
		
		if(types==2 || types==3){
	    	$(".goodsid").show();
	    	$(".recommend").show();
	    }else{
	    	$(".goodsid").hide();
	    	$(".recommend").hide();
	    }
		var leixing = "{$leixing}";
		if(types==1){
	    	$(".link").show();
	    	if(leixing==1){
		    	$(".vedio").show();	
	    	}
	    	$(".fabuleixing").show();
	    }else{
	    	$(".link").hide();
	    	$(".vedio").hide();
	    	$(".fabuleixing").hide();
	    }
		
		 if(types==3){
		    	$(".title").hide();
		    	$(".tag").hide();
		    	$(".author").hide();
		    	$(".click").hide();
		    	$(".num").hide();
		    }else{
		    	$(".title").show();
		    	$(".tag").show();
		    	$(".author").show();
		    	$(".click").show();
		    	$(".num").show();
		    }
		var ue = UE.getEditor('editor');
	    <notempty name="list">
	            ue.addListener("ready", function () {
	                // editor准备好之后才可以使用
	                ue.setContent('{:htmlspecialchars_decode($list["content"])}');
	            });
	    </notempty>
		//上传图片
		$("#upload_img").click(function(){
		   	bind_uploadOne({
		   		uploadUrl : '{:U("Upload/uploadImg/")}',
		   		bind : '#upload_img',
		   		dataType : 'JSON',
		   		callback : function(data,el){
		   			console.log(data);
		   			if(data.status == 1){			
						$('#img').val(data.url);					
		   				$('.imgDiv').html('<img src="'+data.url+'" width="80" height="80" />');
		   			}else{
		   				layer.msg(data.info);
		   			}
		   		}
		   	})
		})
		//上传视频
		$("#upload_vedio").click(function(){
		   	bind_uploadOne({
		   		uploadUrl : '{:U("Upload/uploadVideo/")}',
		   		bind : '#upload_vedio',
		   		dataType : 'JSON',
		   		callback : function(data,el){
		   			console.log(data);
		   			if(data.status == 1){			
						$('#video').val(data.path);
						$('.imgDiv2').html('<p>'+data.path+'</p>');
		   				layer.msg("上传成功");
		   			}else{
		   				layer.msg(data.info);
		   			}
		   		}
		   	})
		})
	})
</script>
<include file="Public/footer"/>